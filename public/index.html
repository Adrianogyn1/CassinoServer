<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Monitor de Salas</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<style>
    body { background: #f4f4f4; padding: 20px; }
    h1 { text-align: center; margin-bottom: 30px; }
    .card { box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
</style>
</head>
<body>

<div class="container">
    <h1>Salas de Jogos</h1>
    <div id="salas" class="row gy-3"></div>
</div>

<script>
$(document).ready(function() {

    function loadRooms() {
        $.ajax({
            url: 'https://cassinoserver-production.up.railway.app/api/rooms',
            method: 'GET',
            dataType: 'json',
            success: function(rooms) {
                const container = $('#salas');
                container.empty();
                rooms.forEach(room => {
                    room.game = "roleta";
                    container.append(`
                        <div class="col-md-4">
                            <div class="card p-3">
                                <h5>${room.nome}</h5>
                                <p>Status: ${room.status}</p>
                                <p>Histórico: ${room.history.length ? room.history.join(', ') : '-'}</p>
                                <a href="${room.game.toLowerCase()}.html?room=${room.nome}" class="btn btn-primary">Entrar</a>
                            </div>
                        </div>
                    `);
                });
            },
            error: function(err) {
                console.error('Erro ao carregar salas', err);
                $('#salas').html('<div class="alert alert-danger">Não foi possível carregar as salas.</div>');
            }
        });
    }

    loadRooms();

    // Opcional: atualizar automaticamente a cada 10 segundos
    setInterval(loadRooms, 10000);

});
</script>

</body>
</html>
